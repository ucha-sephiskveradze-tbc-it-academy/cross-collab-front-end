<app-header></app-header>

<section class="dashboard">
  <!-- Welcome -->
  <div class="welcome">
    <h1>Welcome back, {{ user.name }}</h1>
    <p>Stay connected with upcoming company events and activities</p>
  </div>

  <!-- Upcoming Events -->
  <section class="section">
    <div class="section-header">
      <h2>Upcoming Events</h2>
      <a routerLink="/events">View all</a>
    </div>

    @if (eventsResource.isLoading()) {
    <div class="loading-state">
      <p>Loading events...</p>
    </div>
    } @else if (eventsResource.error()) {
    <div class="error-state" role="alert">
      <p>Failed to load events. Please try again later.</p>
    </div>
    } @else if (events().length === 0 || upcomingEvents().length === 0) {
    <div class="empty-state">
      <p>No upcoming events at this time.</p>
    </div>
    } @else {
    <div class="event-list">
      @for (event of upcomingEvents(); track event.eventId) {
      <app-event-card [event]="event" />
      }
    </div>
    }
  </section>

  <app-categories></app-categories>

  <!-- Trending -->
  <section class="section">
    <h2>Trending Events</h2>

    @if (eventsResource.isLoading()) {
    <div class="loading-state">
      <p>Loading trending events...</p>
    </div>
    } @else if (eventsResource.error()) {
    <div class="error-state" role="alert">
      <p>Failed to load trending events.</p>
    </div>
    } @else if (events().length === 0 || trendingEvents().length === 0) {
    <div class="empty-state">
      <p>No trending events at this time.</p>
    </div>
    } @else {
    <div class="trending">
      @for (event of trendingEvents(); track event.eventId) {
      <div class="trending-card">
        <div class="category-icon-wrapper" [style.background]="getCategoryGradient(event.category.categoryName)">
          <img [src]="getCategoryIcon(event.category.categoryName)" [alt]="event.category.categoryName"
            class="category-icon" />
        </div>

        <h4>{{ event.title }}</h4>

        <p class="category-name">{{ event.category.categoryName }}</p>

        <p class="registered-count">ðŸ‘¥ {{ event.totalRegistered }} registered</p>

        <app-button label="Register" routerLink="/events/{{ event.eventId }}"
          [disabled]="event.currentUserStatus === 'CONFIRMED'"></app-button>
      </div>
      }
    </div>
    }
  </section>

  <!-- Calendar -->
  <app-calendar></app-calendar>
</section>

<app-footer></app-footer>